<html>

<head>
    <title>React Fetch Data</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@latest/babel.min.js"></script>
</head>

<body>
    <h1>Mt Vernon Bulletins</h1>
    <div id="root"></div>
    <script type="text/babel">

        // A single item in the list
        function Item({ item }) {
            const url = item.html_url.split('/').pop();

            return (
                <li key={item.sha}>
                    <a href={url}>{item.name}</a>
                </li>
            );
        }

        // Filter the data to only include .md and .pdf files
        // Puts the .md files first
        function itemList(data) {
            return [
                ...data.filter(item => item.path.endsWith('.md')),
                ...data.filter(item => item.path.endsWith('.pdf'))
            ]
        }

        function App() {
            const [data, setData] = React.useState([]);

            React.useEffect(() => {
                // Using the github API, get all of the entries
                // in https://pastor-robert/mtv/bulletins
                fetch('https://api.github.com/repos/pastor-robert/mtv/contents/bulletin')
                    .then(response => response.json())
                    .then(data => setData(data));
            }, []);

            return (
                <ul>
                    {itemList(data).map(item => <Item item={item} />)}
                </ul>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>

</html>